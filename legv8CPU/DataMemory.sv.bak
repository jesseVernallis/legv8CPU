`include "headers/bus.svh"
`include "headers/files.svh"

module DataMemory #(parameter INSTRPATH =`MEM_FILE,
						  parameter INSTRNUM  = 1024)(
input logic mem_clk,
reset,
read_enable,
write_enable,
input logic [`REGDATASIZE-1:0] addr,
write_data,
output logic [`REGDATASIZE-1:0] read_data
);

 logic [`REGDATASIZE-1:0] mem_data[INSTRNUM];

 initial begin
	 $readmemb(INSTRPATH,mem_data);
 end
 
 always_ff @(posedge reset, posedge mem_clk) begin
	 if(reset) begin
		 read_data <= `REGDATASIZE'b0;
	 end 
	 else if(read_enable) begin
		 read_data <= datamem[addr/8];
	 end
	 else if(write_enable) begin
		 data_mem[addr/8] <= write_data;
		 read_data <= `REGDATASIZE'b0;
	 end
	 else begin
		 read_data <= `REGDATASIZE'b0;
	 end
 end
endmodule : DataMemory